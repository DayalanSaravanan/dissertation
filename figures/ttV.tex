\makeatletter
\tikzset{
  position/.style args={#1 degrees from #2}{
    at=(#2.#1), anchor=#1+180, shift=(#1:\tikz@node@distance)
  }
}
\makeatother

\begin{subfigure}{0.5\linewidth}
  \centering
\begin{tikzpicture}
  \begin{feynman} [nodes=circle]
    \vertex (a);
    \vertex [above=of a] (b);
    \vertex [right=of b] (c);
    \vertex [position=165 degrees from b] (f1) {\(\mbox{g}\)};
    \vertex [position=195 degrees from a] (f2) {\(\mbox{g}\)};
    \vertex [position=15 degrees from c] (f3) {\(\mbox{t}\)};
    \vertex [position=-15 degrees from c] (f4) {\(\mbox{Z/$\gamma^*$}\)};
    \vertex at (f4 |- f2) (f5) {\(\bar{\mbox{t}}\)};

      \diagram* [arrow size=1pt] {
        (f1) -- [gluon] (b) -- [fermion, edge label=\(\mbox{t}\)] (c),
        (a) -- [fermion, edge label'=\(\mbox{t}\)] (b),
        (f2) -- [gluon] (a),
        (a) -- [anti fermion] (f5),
        (f3) -- [anti fermion] (c) -- [boson] (f4),
      };
    \end{feynman}
  \end{tikzpicture}
  % \begin{tikzpicture}
  %   \begin{feynman}
  %     \diagram [arrow size=1pt, horizontal'=a to b] {
  %       i1 [particle=\(g\)] -- [gluon] a -- [gluon] i2 [particle=\(g\)],
  %       a -- [gluon, edge label'=\(g\)] b,
  %       f1 [particle=\(\bar{t}\)] -- [opacity=0] b -- [fermion] f2 [particle=\(t\)],
  %     };

  %     % see section 13.5 in http://ctan.mirrors.hoobly.com/graphics/pgf/base/doc/pgfmanual.pdf
  %     \vertex at ($(f1)!0.5!(b)$) (c);
  %     \vertex at ($(f2)!0.45!(f1)$) (d) {\(Z\)};

  %     \diagram* [arrow size=1pt] {
  %       (c) -- [boson] (d),
  %       (f1) -- [fermion] (c) -- [fermion] (b),
  %     };
  %   \end{feynman}
  % \end{tikzpicture}
  \caption{}
  \label{sfig:ttZ}
\end{subfigure}%
\begin{subfigure}{0.5\linewidth}
  \centering
  \begin{tikzpicture}
    \begin{feynman} [nodes=circle]
      \vertex (a);
      \vertex [above=of a] (b);
      \vertex [right=of b] (c);
      \vertex [position=165 degrees from b] (f1) {\(\bar{d}\)};
      \vertex [position=195 degrees from a] (f2) {\(u\)};
      \vertex [position=15 degrees from c] (f3) {\(\bar{t}\)};
      \vertex [position=-15 degrees from c] (f4) {\(t\)};
      \vertex at (f4 |- f2) (f5) {\(W+\)};

      \diagram* [arrow size=1pt] {
        (f1) -- [anti fermion] (b) -- [gluon, edge label=\(g\)] (c),
        (a) -- [fermion, edge label'=\(d\)] (b),
        (f2) -- [fermion] (a),
        (a) -- [boson] (f5),
        (f3) -- [fermion] (c) -- [fermion] (f4),
      };
    \end{feynman}
  \end{tikzpicture}
  \caption{}
  \label{sfig:ttW}
\end{subfigure}
